rule Unknown_Malware_32Bit_VisualBasic_Haitham {
    meta:
        authors = "Rahaf Hajeer and Hind Aljubeh"
        description = "Detection for Unknown_Malware.exe, a 32-bit Visual Basic malware authored by Haitham"

    strings:
        $prompt1 = "PSUT.dll is missing!"
        $prompt2 = "No internet, No game"
        $dns = "google.com"

    condition:
        uint32(0) == 0x00454c46 and all of them and 
        (hash.md5(0, filesize) == "6147B3DF04D5D93D9186F3EDE6E74B71" )
        
    condition:
        any of ($prompt*) and 
        (processes("Updator.exe")) and
         (network.tls or (network.dns and $dns))
}
